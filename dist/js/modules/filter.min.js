/* Tabulator v4.0.0 (c) Oliver Folkerd */
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Filter=function(e){this.table=e,this.filterList=[],this.headerFilters={},this.headerFilterElements=[],this.changed=!1};Filter.prototype.initializeColumn=function(e){function t(t){var i,r="input"==s&&"text"==u||"textarea"==s?"partial":"match",n="";if(t){switch(_typeof(e.definition.headerFilterFunc)){case"string":f.filters[e.definition.headerFilterFunc]?(n=e.definition.headerFilterFunc,i=function(i){return f.filters[e.definition.headerFilterFunc](t,e.getFieldValue(i))}):console.warn("Header Filter Error - Matching filter function not found: ",e.definition.headerFilterFunc);break;case"function":i=function(i){return e.definition.headerFilterFunc(t,e.getFieldValue(i),i,e.definition.headerFilterFuncParams||{})},n=i}if(!i)switch(r){case"partial":i=function(i){return String(e.getFieldValue(i)).toLowerCase().indexOf(String(t).toLowerCase())>-1},n="like";break;default:i=function(i){return e.getFieldValue(i)==t},n="="}f.headerFilters[d]={value:t,func:i,type:n}}else delete f.headerFilters[d];f.changed=!0,f.table.rowManager.filterRefresh()}function i(){}var r,n,o,l,a,s,u,f=this,d=e.getField();if(e.modules.filter={success:t},d){switch(r=$("<div class='tabulator-header-filter'></div>"),_typeof(e.definition.headerFilter)){case"string":f.table.modules.edit.editors[e.definition.headerFilter]?n=f.table.modules.edit.editors[e.definition.headerFilter]:console.warn("Filter Error - Cannot build header filter, No such editor found: ",e.definition.editor);break;case"function":n=e.definition.headerFilter;break;case"boolean":n=e.modules.edit&&e.modules.edit.editor?e.modules.edit.editor:e.definition.formatter&&f.table.modules.edit.editors[e.definition.formatter]?f.table.modules.edit.editors[e.definition.formatter]:f.table.modules.edit.editors.input}n&&(l={getValue:function(){return""},getField:function(){return e.definition.field},getElement:function(){return r},getRow:function(){return{normalizeHeight:function(){}}}},o=n.call(f,l,function(){},t,i,e.definition.headerFilterParams||{}),d?f.table.modules.localize.bind("headerFilters|columns|"+e.definition.field,function(e){o.attr("placeholder",void 0!==e&&e?e:f.table.modules.localize.getText("headerFilters|default"))}):f.table.modules.localize.bind("headerFilters|default",function(e){o.attr("placeholdder",void 0!==f.column.definition.headerFilterPlaceholder&&f.column.definition.headerFilterPlaceholder?f.column.definition.headerFilterPlaceholder:e)}),o.on("click",function(e){e.stopPropagation(),$(this).focus()}),a=!1,o.on("keyup search",function(e){var i=$(this);a&&clearTimeout(a),a=setTimeout(function(){t(i.val())},300)}),e.modules.filter.headerElement=o,u=o.attr("type")?o.attr("type").toLowerCase():"","number"==u&&o.on("change",function(e){t($(this).val())}),"text"==u&&"ie"!==this.table.browser&&(o.attr("type","search"),o.off("change blur")),s=o.prop("tagName").toLowerCase(),"input"!=s&&"select"!=s&&"textarea"!=s||o.on("mousedown",function(e){e.stopPropagation()}),r.append(o),e.contentElement.append(r),f.headerFilterElements.push(o))}else console.warn("Filter Error - Cannot add header filter, column has no field set:",e.definition.title)},Filter.prototype.hideHeaderFilterElements=function(){this.headerFilterElements.forEach(function(e){e.hide()})},Filter.prototype.showHeaderFilterElements=function(){this.headerFilterElements.forEach(function(e){e.show()})},Filter.prototype.setHeaderFilterFocus=function(e){e.modules.filter&&e.modules.filter.headerElement?e.modules.filter.headerElement.focus():console.warn("Column Filter Focus Error - No header filter set on column:",e.getField())},Filter.prototype.setHeaderFilterValue=function(e,t){e&&(e.modules.filter&&e.modules.filter.headerElement?(e.modules.filter.headerElement.val(t),e.modules.filter.success(t)):console.warn("Column Filter Error - No header filter set on column:",e.getField()))},Filter.prototype.hasChanged=function(){var e=this.changed;return this.changed=!1,e},Filter.prototype.setFilter=function(e,t,i){var r=this;r.filterList=[],Array.isArray(e)||(e=[{field:e,type:t,value:i}]),r.addFilter(e)},Filter.prototype.addFilter=function(e,t,i){var r=this;Array.isArray(e)||(e=[{field:e,type:t,value:i}]),e.forEach(function(e){(e=r.findFilter(e))&&(r.filterList.push(e),r.changed=!0)}),this.table.options.persistentFilter&&this.table.modExists("persistence",!0)&&this.table.modules.persistence.save("filter")},Filter.prototype.findFilter=function(e){var t,i=this;if(Array.isArray(e))return this.findSubFilters(e);var r=!1;return"function"==typeof e.field?r=function(t){return e.field(t,e.type||{})}:i.filters[e.type]?(t=i.table.columnManager.getColumnByField(e.field),r=t?function(r){return i.filters[e.type](e.value,t.getFieldValue(r))}:function(t){return i.filters[e.type](e.value,t[e.field])}):console.warn("Filter Error - No such filter type found, ignoring: ",e.type),e.func=r,!!e.func&&e},Filter.prototype.findSubFilters=function(e){var t=this,i=[];return e.forEach(function(e){(e=t.findFilter(e))&&i.push(e)}),!!i.length&&i},Filter.prototype.getFilters=function(e,t){var i=this,r=[];return e&&(r=i.getHeaderFilters()),i.filterList.forEach(function(e){r.push({field:e.field,type:e.type,value:e.value})}),t&&r.forEach(function(e){"function"==typeof e.type&&(e.type="function")}),r},Filter.prototype.getHeaderFilters=function(){var e=[];for(var t in this.headerFilters)e.push({field:t,type:this.headerFilters[t].type,value:this.headerFilters[t].value});return e},Filter.prototype.removeFilter=function(e,t,i){var r=this;Array.isArray(e)||(e=[{field:e,type:t,value:i}]),e.forEach(function(e){var t=-1;t="object"==_typeof(e.field)?r.filterList.findIndex(function(t){return e===t}):r.filterList.findIndex(function(t){return e.field===t.field&&e.type===t.type&&e.value===t.value}),t>-1?(r.filterList.splice(t,1),r.changed=!0):console.warn("Filter Error - No matching filter type found, ignoring: ",e.type)}),this.table.options.persistentFilter&&this.table.modExists("persistence",!0)&&this.table.modules.persistence.save("filter")},Filter.prototype.clearFilter=function(e){this.filterList=[],e&&this.clearHeaderFilter(),this.changed=!0,this.table.options.persistentFilter&&this.table.modExists("persistence",!0)&&this.table.modules.persistence.save("filter")},Filter.prototype.clearHeaderFilter=function(){this.headerFilters={},this.headerFilterElements.forEach(function(e){e.val("")}),this.changed=!0},Filter.prototype.filter=function(e){var t=this,i=[],r=[];return t.table.options.dataFiltering&&t.table.options.dataFiltering(t.getFilters()),t.table.options.ajaxFiltering||!t.filterList.length&&!Object.keys(t.headerFilters).length?i=e.slice(0):e.forEach(function(e){t.filterRow(e)&&i.push(e)}),t.table.options.dataFiltered&&(i.forEach(function(e){r.push(e.getComponent())}),t.table.options.dataFiltered(t.getFilters(),r)),i},Filter.prototype.filterRow=function(e){var t=this,i=!0,r=e.getData();t.filterList.forEach(function(e){t.filterRecurse(e,r)||(i=!1)});for(var n in t.headerFilters)t.headerFilters[n].func(r)||(i=!1);return i},Filter.prototype.filterRecurse=function(e,t){var i=this,r=!1;return Array.isArray(e)?e.forEach(function(e){i.filterRecurse(e,t)&&(r=!0)}):r=e.func(t),r},Filter.prototype.filters={"=":function(e,t){return t==e},"<":function(e,t){return t<e},"<=":function(e,t){return t<=e},">":function(e,t){return t>e},">=":function(e,t){return t>=e},"!=":function(e,t){return t!=e},like:function(e,t){return null===e||void 0===e?t===e:void 0!==t&&null!==t&&String(t).toLowerCase().indexOf(e.toLowerCase())>-1},in:function(e,t){return Array.isArray(e)?e.indexOf(t)>-1:(console.warn("Filter Error - filter value is not an array:",e),!1)}},Tabulator.prototype.registerModule("filter",Filter);