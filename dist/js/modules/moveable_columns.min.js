/* Tabulator v4.0.0 (c) Oliver Folkerd */
"use strict";var MoveColumns=function(e){this.table=e,this.placeholderElement=$("<div class='tabulator-col tabulator-col-placeholder'></div>"),this.hoverElement=$(),this.checkTimeout=!1,this.checkPeriod=250,this.moving=!1,this.toCol=!1,this.toColAfter=!1,this.startX=0,this.autoScrollMargin=40,this.autoScrollStep=5,this.autoScrollTimeout=!1,this.moveHover=this.moveHover.bind(this),this.endMove=this.endMove.bind(this)};MoveColumns.prototype.initializeColumn=function(e){var o,t=this,l={};e.modules.frozen||(o=e.getElement(),l.mousemove=function(l){e.parent===t.moving.parent&&(l.pageX-Tabulator.prototype.helpers.elOffset(o).left+t.table.columnManager.element.scrollLeft>e.getWidth()/2?t.toCol===e&&t.toColAfter||(o.parentNode.insertBefore(t.placeholderElement,o.nextSibling),t.moveColumn(e,!0)):(t.toCol!==e||t.toColAfter)&&(o.parentNode.insertBefore(t.placeholderElement,o),t.moveColumn(e,!1)))}.bind(t),o.addEventListener("mousedown",function(o){t.checkTimeout=setTimeout(function(){t.startMove(o,e)},t.checkPeriod)}),o.addEventListener("mouseup",function(e){t.checkTimeout&&clearTimeout(t.checkTimeout)})),e.modules.moveColumn=l},MoveColumns.prototype.startMove=function(e,o){var t=this,l=o.getElement();t.moving=o,t.startX=e.pageX-Tabulator.prototype.helpers.elOffset(l.left),t.table.element.classList.add("tabulator-block-select"),t.placeholderElement.css({width:o.getWidth(),height:o.getHeight()}),l.parentNode.insertBefore(t.placeholderElement,l),l.parentNode.removeChild(l),t.hoverElement=l.cloneNode(!0),t.hoverElement.classList.add("tabulator-moving"),t.table.columnManager.getElement().appendChild(t.hoverElement[0]),t.hoverElement.css({left:0,bottom:0}),t._bindMouseMove(),$("body").on("mousemove",t.moveHover),$("body").on("mouseup",t.endMove),t.moveHover(e)},MoveColumns.prototype._bindMouseMove=function(){this.table.columnManager.columnsByIndex.forEach(function(e){e.modules.moveColumn.mousemove&&e.getElement().addEventListener("mousemove",e.modules.moveColumn.mousemove)})},MoveColumns.prototype._unbindMouseMove=function(){this.table.columnManager.columnsByIndex.forEach(function(e){e.modules.moveColumn.mousemove&&e.getElement().removeEventListener("mousemove",e.modules.moveColumn.mousemove)})},MoveColumns.prototype.moveColumn=function(e,o){var t=this,l=this.moving.getCells();t.toCol=e,t.toColAfter=o,o?e.getCells().forEach(function(e,o){var t=e.getElement();t.parentNode.insertBefore(l[o].getElement(),t.nextSibling)}):e.getCells().forEach(function(e,o){var t=e.getElement();t.parentNode.insertBefore(l[o].getElement(),t)})},MoveColumns.prototype.endMove=function(e){var o=this;o._unbindMouseMove(),o.placeholderElement.after(o.moving.getElement()),o.placeholderElement.detach(),o.hoverElement.detach(),o.table.element.classList.remove("tabulator-block-select"),o.toCol&&o.table.columnManager.moveColumn(o.moving,o.toCol,o.toColAfter),o.moving=!1,o.toCol=!1,o.toColAfter=!1,$("body").off("mousemove",o.moveHover),$("body").off("mouseup",o.endMove)},MoveColumns.prototype.moveHover=function(e){var o,t=this,l=t.table.columnManager.getElement(),n=l.scrollLeft,m=e.pageX-Tabulator.prototype.helpers.elOffset(l).left+n;t.hoverElement.css({left:m-t.startX}),m-n<t.autoScrollMargin&&(t.autoScrollTimeout||(t.autoScrollTimeout=setTimeout(function(){o=Math.max(0,n-5),t.table.rowManager.getElement().scrollLeft=o,t.autoScrollTimeout=!1},1))),n+l.clientWidth-m<t.autoScrollMargin&&(t.autoScrollTimeout||(t.autoScrollTimeout=setTimeout(function(){o=Math.min(l.clientWidth,n+5),t.table.rowManager.getElement().scrollLeft=o,t.autoScrollTimeout=!1},1)))},Tabulator.prototype.registerModule("moveColumn",MoveColumns);