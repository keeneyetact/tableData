/* Tabulator v4.0.0 (c) Oliver Folkerd */
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Edit=function(e){this.table=e,this.currentCell=!1,this.mouseClick=!1,this.recursionBlock=!1,this.invalidEdit=!1};Edit.prototype.initializeColumn=function(e){var t=this,i={editor:!1,blocked:!1,check:e.definition.editable,params:e.definition.editorParams||{}};switch(_typeof(e.definition.editor)){case"string":t.editors[e.definition.editor]?i.editor=t.editors[e.definition.editor]:console.warn("Editor Error - No such editor found: ",e.definition.editor);break;case"function":i.editor=e.definition.editor;break;case"boolean":!0===e.definition.editor&&("function"!=typeof e.definition.formatter?t.editors[e.definition.formatter]?i.editor=t.editors[e.definition.formatter]:i.editor=t.editors.input:console.warn("Editor Error - Cannot auto lookup editor for a custom formatter: ",e.definition.formatter))}i.editor&&(e.modules.edit=i)},Edit.prototype.getCurrentCell=function(){return!!this.currentCell&&this.currentCell.getComponent()},Edit.prototype.clearEditor=function(){var e,t=this.currentCell;if(this.invalidEdit=!1,t){for(this.currentCell=!1,e=t.getElement(),e.classList.remove("tabulator-validation-fail"),e.classList.remove("tabulator-editing");e.firstChild;)e.removeChild(e.firstChild);t.row.getElement().classList.remove("tabulator-row-editing")}},Edit.prototype.cancelEdit=function(){if(this.currentCell){var e=this.currentCell,t=this.currentCell.getComponent();this.clearEditor(),e.setValueActual(e.getValue()),e.column.cellEvents.cellEditCancelled&&e.column.cellEvents.cellEditCancelled(t),this.table.options.cellEditCancelled(t)}},Edit.prototype.bindEditor=function(e){var t=this,i=e.getElement();i.setAttribute("tabindex",0),i.addEventListener("click",function(e){i.classList.contains("tabulator-editing")||i.focus()}),i.addEventListener("mousedown",function(e){t.mouseClick=!0}),i.addEventListener("focus",function(i){t.recursionBlock||t.edit(e,i,!1)})},Edit.prototype.focusCellNoEvent=function(e){this.recursionBlock=!0,e.getElement().focus(),this.recursionBlock=!1},Edit.prototype.editCell=function(e,t){this.focusCellNoEvent(e),this.edit(e,!1,t)},Edit.prototype.edit=function(e,t,i){function n(t){if(s.currentCell===e){var i=!0;e.column.modules.validate&&s.table.modExists("validate")&&(i=s.table.modules.validate.validate(e.column.modules.validate,e.getComponent(),t)),!0===i?(s.clearEditor(),e.setValue(t,!0)):(s.invalidEdit=!0,u.classList.add("tabulator-validation-fail"),s.focusCellNoEvent(e),c(),s.table.options.validationFailed(e.getComponent(),t,i))}else console.warn("Edit Success Error - cannot call success on a cell that is no longer being edited")}function o(){s.currentCell===e?s.cancelEdit():console.warn("Edit Success Error - cannot call cancel on a cell that is no longer being edited")}function r(e){c=e}var a,l,s=this,d=!0,c=function(){},u=e.getElement();if(this.currentCell){if(this.invalidEdit)return;return void this.cancelEdit()}if(e.column.modules.edit.blocked)return this.mouseClick=!1,u.blur(),!1;switch(t&&t.stopPropagation(),_typeof(e.column.modules.edit.check)){case"function":d=e.column.modules.edit.check(e.getComponent());break;case"boolean":d=e.column.modules.edit.check}if(d||i){if(s.cancelEdit(),s.currentCell=e,l=e.getComponent(),this.mouseClick&&(this.mouseClick=!1,e.column.cellEvents.cellClick&&e.column.cellEvents.cellClick(l)),e.column.cellEvents.cellEditing&&e.column.cellEvents.cellEditing(l),s.table.options.cellEditing(l),!1===(a=e.column.modules.edit.editor.call(s,l,r,n,o,e.column.modules.edit.params)))return u.blur(),!1;for(u.classList.add("tabulator-editing"),e.row.getElement().classList.add("tabulator-row-editing");u.firstChild;)u.removeChild(u.firstChild);u.appendChild(a),c();for(var p=u.children,f=0;f<p.length;f++)p[f].addEventListener("click",function(e){e.stopPropagation()});return!0}return this.mouseClick=!1,u.blur(),!1},Edit.prototype.editors={input:function(e,t,i,n,o){function r(e){l.value!=a?i(l.value):n()}var a=e.getValue(),l=document.createElement("input");return l.setAttribute("type","text"),l.style.padding="4px",l.style.width="100%",l.style.boxSizing="border-box",l.value=a,t(function(){l.focus(),l.style.height="100%"}),l.addEventListener("change",r),l.addEventListener("blur",r),l.addEventListener("keydown",function(e){13==e.keyCode&&i(l.value),27==e.keyCode&&n()}),l},textarea:function(e,t,i,n,o){function r(t){s.value!=a?(i(s.value),setTimeout(function(){e.getRow().normalizeHeight()},300)):n()}var a=e.getValue(),l=String("null"==typeof a||void 0===a?"":a),s=(l.match(/(?:\r\n|\r|\n)/g),document.createElement("textarea")),d=0;return s.style.display="block",s.style.padding="2px",s.style.height="100%",s.style.width="100%",s.style.boxSizing="border-box",s.style.whiteSpace="pre-wrap",s.style.resize="none",s.value=l,t(function(){s.focus(),s.style.height="100%"}),s.addEventListener("change",r),s.addEventListener("blur",r),s.addEventListener("keyup",function(){s.style.height="";var t=s.scrollHeight;s.style.height=t+"px",t!=d&&(d=t,e.getRow().normalizeHeight())}),s.addEventListener("keydown",function(e){27==e.keyCode&&n()}),s},number:function(e,t,i,n,o){var r=e.getValue(),a=document.createElement("input");return a.setAttribute("type","number"),void 0!==o.max&&a.setAttribute("max",o.max),void 0!==o.min&&a.setAttribute("min",o.min),void 0!==o.step&&a.setAttribute("step",o.step),a.style.padding="4px",a.style.width="100%",a.style.boxSizing="border-box",a.value=r,t(function(){a.focus(),a.style.height="100%"}),a.addEventListener("blur",function(e){var t=a.value;isNaN(t)||(t=Number(t)),t!=r?i(t):n()}),a.addEventListener("keydown",function(e){var t;13==e.keyCode&&(t=a.value,isNaN(t)||(t=Number(t)),i(t)),27==e.keyCode&&n()}),a},range:function(e,t,i,n,o){var r=e.getValue(),a=document.createElement("input");return a.setAttribute("type","range"),void 0!==o.max&&a.setAttribute("max",o.max),void 0!==o.min&&a.setAttribute("min",o.min),void 0!==o.step&&a.setAttribute("step",o.step),a.style.padding="4px",a.style.width="100%",a.style.boxSizing="border-box",a.value=r,t(function(){a.focus(),a.style.height="100%"}),a.addEventListener("blur",function(e){var t=a.value;isNaN(t)||(t=Number(t)),t!=r?i(t):n()}),a.addEventListener("keydown",function(e){var t;13==e.keyCode&&(t=a.value,isNaN(t)||(t=Number(t)),i(t)),27==e.keyCode&&n()}),a},select:function(e,t,i,n,o){function r(e,t,i,n){var o=document.createElement("option");o.value=i,o.text=t,n&&(o.disabled=!0),e.appendChild(o)}function a(e,t){var i;t.options?(i=document.createElement("optgroup"),i.setAttribute("lavel",t.label),t.options.forEach(function(e){a(i,e)}),e.appendChild(i)):r(e,void 0===t.label?t.value:t.label,void 0===t.value?t.label:t.value,t.disabled)}function l(e){s.selectedIndex>-1?i(s.options[s.selectedIndex].value):n()}var s=document.createElement("select"),d=Array.isArray(o);if("function"==typeof o&&(o=o(e),d=Array.isArray(o)),d||"object"!==(void 0===o?"undefined":_typeof(o)))d&&o.forEach(function(e){a(s,e)});else for(var c in o)r(s,o[c],c);return s.style.padding="4px",s.style.width="100%",s.style.boxSizing="border-box",s.style.fontFamily="",s.value=e.getValue(),t(function(){s.focus()}),s.addEventListener("change",l),s.addEventListener("blur",l),s.addEventListener("keydown",function(e){13===e.keyCode&&i(s.options[s.selectedIndex].value)}),s},star:function(e,t,i,n,o){function r(e){p.forEach(function(t,i){i<e?("ie"==l.table.browser?t.setAttribute("class","tabulator-star-active"):t.classList.replace("tabulator-star-inactive","tabulator-star-active"),t.innerHTML='<polygon fill="#488CE9" stroke="#014AAE" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>'):("ie"==l.table.browser?t.setAttribute("class","tabulator-star-inactive"):t.classList.replace("tabulator-star-active","tabulator-star-inactive"),t.innerHTML='<polygon fill="#010155" stroke="#686868" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>')})}function a(e){d=e,r(e)}var l=this,s=e.getElement(),d=e.getValue(),c=s.getElementsByTagName("svg").length||5,u=s.getElementsByTagName("svg")[0]?s.getElementsByTagName("svg")[0].getAttribute("width"):14,p=[],f=document.createElement("div"),m=document.createElementNS("http://www.w3.org/2000/svg","svg");s.style.whiteSpace="nowrap",s.style.overflow="hidden",s.style.textOverflow="ellipsis",f.style.verticalAlign="middle",f.style.display="inline-block",f.style.padding="4px",m.setAttribute("width",u),m.setAttribute("height",u),m.setAttribute("viewBox","0 0 512 512"),m.setAttribute("xml:space","preserve"),m.style.padding="0 1px";for(var v=1;v<=c;v++)!function(e){var t=m.cloneNode(!0);p.push(t),t.addEventListener("mouseover",function(t){t.stopPropagation(),r(e)}),t.addEventListener("click",function(t){t.stopPropagation(),i(e)}),f.appendChild(t)}(v);return d=Math.min(parseInt(d),c),r(d),f.addEventListener("mouseover",function(e){r(0)}),f.addEventListener("click",function(e){i(0)}),s.addEventListener("blur",function(e){n()}),s.addEventListener("keydown",function(e){switch(e.keyCode){case 39:a(d+1);break;case 37:a(d-1);break;case 13:i(d);break;case 27:n()}}),f},progress:function(e,t,i,n,o){var r,a=e.getElement(),l=$("div",a).data("max"),s=$("div",a).data("min"),d=(l-s)/100,c=e.getValue()||0,u=$("<div class='tabulator-progress-handle' style='position:absolute; right:0; top:0; bottom:0; width:5px;'></div>"),p=function(){var e=d*Math.round(r.outerWidth()/(a.width()/100))+s;i(e),a.attr("aria-valuenow",e).attr("aria-label",c)};return c=parseFloat(c)<=l?parseFloat(c):l,c=parseFloat(c)>=s?parseFloat(c):s,c=100-Math.round((c-s)/d),r=$("<div style='position:absolute; top:8px; bottom:8px; left:4px; right:"+c+"%; margin-right:4px; background-color:#488CE9; display:inline-block; max-width:100%; min-width:0%;' data-max='"+l+"' data-min='"+s+"'></div>"),a.css({padding:"0 4px"}),a.attr("aria-valuemin",s).attr("aria-valuemax",l),r.append(u),u.on("mousedown",function(e){r.data("mouseDrag",e.screenX),r.data("mouseDragWidth",r.outerWidth())}),u.on("mouseover",function(){$(this).css({cursor:"ew-resize"})}),a.on("mousemove",function(e){r.data("mouseDrag")&&r.css({width:r.data("mouseDragWidth")+(e.screenX-r.data("mouseDrag"))})}),a.on("mouseup",function(e){r.data("mouseDrag")&&(e.stopPropagation(),e.stopImmediatePropagation(),r.data("mouseDragOut",!0),r.data("mouseDrag",!1),r.data("mouseDragWidth",!1),p())}),a.on("keydown",function(e){switch(e.keyCode){case 39:r.css({width:r.width()+a.width()/100});break;case 37:r.css({width:r.width()-a.width()/100});break;case 13:p();break;case 27:n()}}),a.on("blur",function(){n()}),r[0]},tickCross:function(e,t,i,n,o){var r=e.getValue(),a=$("<input type='checkbox'/>");return a.css({"margin-top":"5px","box-sizing":"border-box"}).val(r),"firefox"!=this.table.browser&&t(function(){a.focus()}),!0===r||"true"===r||"True"===r||1===r?a.prop("checked",!0):a.prop("checked",!1),a.on("change blur",function(e){i(a.is(":checked"))}),a.on("keydown",function(e){13==e.keyCode&&i(a.is(":checked")),27==e.keyCode&&n()}),a[0]},tick:function(e,t,i,n,o){var r=e.getValue(),a=$("<input type='checkbox'/>");return a.css({"margin-top":"5px","box-sizing":"border-box"}).val(r),"firefox"!=this.table.browser&&t(function(){a.focus()}),!0===r||"true"===r||"True"===r||1===r?a.prop("checked",!0):a.prop("checked",!1),a.on("change blur",function(e){i(a.is(":checked"))}),a.on("keydown",function(e){13==e.keyCode&&i(a.is(":checked")),27==e.keyCode&&n()}),a[0]}},Tabulator.prototype.registerModule("edit",Edit);