/* Tabulator v4.2.6 (c) Oliver Folkerd */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},HtmlTableExport=function(t){this.table=t,this.config={},this.cloneTableStyle=!0};HtmlTableExport.prototype.genereateTable=function(t,e){this.cloneTableStyle=e,this.config=t||{};var o=this.generateHeaderElements(),r=this.generateBodyElements(),n=document.createElement("table");return n.classList.add("tabulator-print-table"),n.appendChild(o),n.appendChild(r),this.mapElementStyles(this.table.element,n,["border-top","border-left","border-right","border-bottom"]),n},HtmlTableExport.prototype.generateColumnGroupHeaders=function(){var t=this,e=[];return(!1!==this.config.columnGroups?this.table.columnManager.columns:this.table.columnManager.columnsByIndex).forEach(function(o){var r=t.processColumnGroup(o);r&&e.push(r)}),e},HtmlTableExport.prototype.processColumnGroup=function(t){var e=this,o=t.columns,r=0,n={title:t.definition.title,column:t,depth:1};if(o.length){if(n.subGroups=[],n.width=0,o.forEach(function(t){var o=e.processColumnGroup(t);o&&(n.width+=o.width,n.subGroups.push(o),o.depth>r&&(r=o.depth))}),n.depth+=r,!n.width)return!1}else{if(!t.field||!t.visible)return!1;n.width=1}return n},HtmlTableExport.prototype.groupHeadersToRows=function(t){function e(t,n){var l=r-n;void 0===o[n]&&(o[n]=[]),t.height=t.subGroups?1:l-t.depth+1,o[n].push(t),t.subGroups&&t.subGroups.forEach(function(t){e(t,n+1)})}var o=[],r=0;return t.forEach(function(t){t.depth>r&&(r=t.depth)}),t.forEach(function(t){e(t,0)}),o},HtmlTableExport.prototype.generateHeaderElements=function(){var t=this,e=document.createElement("thead");return this.groupHeadersToRows(this.generateColumnGroupHeaders()).forEach(function(o){var r=document.createElement("tr");t.mapElementStyles(t.table.columnManager.getHeadersElement(),e,["border-top","border-left","border-right","border-bottom","background-color","color","font-weight","font-family","font-size"]),o.forEach(function(e){var o=document.createElement("th");o.colSpan=e.width,o.rowSpan=e.height,o.innerHTML=e.column.definition.title,t.mapElementStyles(e.column.getElement(),o,["text-align","border-top","border-left","border-right","border-bottom","background-color","color","font-weight","font-family","font-size"]),t.mapElementStyles(e.column.contentElement,o,["padding-top","padding-left","padding-right","padding-bottom"]),e.column.parent&&t.mapElementStyles(e.column.parent.groupElement,o,["border-top"]),r.appendChild(o)}),e.appendChild(r)}),e},HtmlTableExport.prototype.generateBodyElements=function(){var t,e,o,r,n,l,a,i,d=this;this.cloneTableStyle&&window.getComputedStyle&&(t=this.table.element.querySelector(".tabulator-row-odd:not(.tabulator-group):not(.tabulator-calcs)"),e=this.table.element.querySelector(".tabulator-row-even:not(.tabulator-group):not(.tabulator-calcs)"),o=this.table.element.querySelector(".tabulator-row.tabulator-calcs"),r=this.table.element.querySelector(".tabulator-row:not(.tabulator-group):not(.tabulator-calcs)"),l=this.table.element.getElementsByClassName("tabulator-group")[0],r&&(a=r.getElementsByClassName("tabulator-cell"),n=a[0],a[a.length-1]));var u=document.createElement("tbody"),p=this.table.rowManager.getDisplayRows(),c=this.table.columnManager.columnsByIndex;return p=p.filter(function(t){switch(t.type){case"group":return!1!==d.config.rowGroups;case"calc":return!1!==d.config.columnCalcs}return!0}),p.forEach(function(r,a){var p=r.getData(),m=document.createElement("tr");switch(m.classList.add("tabulator-print-table-row"),r.type){case"group":var s=document.createElement("td");s.colSpan=c.length,s.innerHTML=r.key,m.classList.add("tabulator-print-table-group"),d.mapElementStyles(l,m,["border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","background-color"]),d.mapElementStyles(l,s,["padding-top","padding-left","padding-right","padding-bottom"]),m.appendChild(s);break;case"calc":m.classList.add("tabulator-print-table-calcs");case"row":c.forEach(function(t){var e=document.createElement("td"),o=t.getFieldValue(p),r={getValue:function(){return o},getField:function(){return t.definition.field},getElement:function(){return e},getColumn:function(){return t.getComponent()},getRow:function(){return{normalizeHeight:function(){}}},getComponent:function(){return r},column:t};if(d.table.modExists("format"))o=d.table.modules.format.formatValue(r);else switch(void 0===o?"undefined":_typeof(o)){case"object":o=JSON.stringify(o);break;case"undefined":case"null":o="";break;default:o=o}o instanceof Node?e.appendChild(o):e.innerHTML=o,n&&d.mapElementStyles(n,e,["padding-top","padding-left","padding-right","padding-bottom","border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size"]),m.appendChild(e)}),i="calc"==r.type?o:a%2&&e?e:t,d.mapElementStyles(i,m,["border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","background-color"])}u.appendChild(m)}),u},HtmlTableExport.prototype.getHtml=function(t){var e=document.createElement("div");return e.appendChild(this.genereateTable()),e.innerHTML},HtmlTableExport.prototype.mapElementStyles=function(t,e,o){if(this.cloneTableStyle&&t&&e){var r={"background-color":"backgroundColor",color:"fontColor","font-weight":"fontWeight","font-family":"fontFamily","font-size":"fontSize","text-align":"textAlign","border-top":"borderTop","border-left":"borderLeft","border-right":"borderRight","border-bottom":"borderBottom","padding-top":"paddingTop","padding-left":"paddingLeft","padding-right":"paddingRight","padding-bottom":"paddingBottom"};if(window.getComputedStyle){var n=window.getComputedStyle(t);o.forEach(function(t){e.style[r[t]]=n.getPropertyValue(t)})}}},Tabulator.prototype.registerModule("htmlTableExport",HtmlTableExport);