/* Tabulator v4.2.5 (c) Oliver Folkerd */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},HtmlTableExport=function(e){this.table=e,this.config={}};HtmlTableExport.prototype.genereateTable=function(e){var t=this.generateHeaderElements(),o=this.generateBodyElements(),n=document.createElement("table");return n.appendChild(t),n.appendChild(o),n},HtmlTableExport.prototype.generateColumnGroupHeaders=function(){var e=this,t=[];return this.table.columnManager.columns.forEach(function(o){var n=e.processColumnGroup(o);n&&t.push(n)}),t},HtmlTableExport.prototype.processColumnGroup=function(e){var t=this,o=e.columns,n=0,r={title:e.definition.title,column:e,depth:1};if(o.length){if(r.subGroups=[],r.width=0,o.forEach(function(e){var o=t.processColumnGroup(e);o&&(r.width+=o.width,r.subGroups.push(o),o.depth>n&&(n=o.depth))}),r.depth+=n,!r.width)return!1}else{if(!e.field||!e.visible)return!1;r.width=1}return r},HtmlTableExport.prototype.groupHeadersToRows=function(e){function t(e,r){var a=n-r;void 0===o[r]&&(o[r]=[]),e.height=e.subGroups?1:a-e.depth+1,o[r].push(e),e.subGroups&&e.subGroups.forEach(function(e){t(e,r+1)})}var o=[],n=0;return e.forEach(function(e){e.depth>n&&(n=e.depth)}),e.forEach(function(e){t(e,0)}),o},HtmlTableExport.prototype.generateHeaderElements=function(){var e=document.createElement("thead");return this.groupHeadersToRows(this.generateColumnGroupHeaders()).forEach(function(t){var o=document.createElement("tr");t.forEach(function(e){var t=document.createElement("th");t.colSpan=e.width,t.rowSpan=e.height,t.innerHTML=e.column.definition.title,o.appendChild(t)}),e.appendChild(o)}),e},HtmlTableExport.prototype.generateBodyElements=function(){var e=document.createElement("tbody"),t=this.table.rowManager.getDisplayRows(),o=this.table.columnManager.columnsByIndex;return t.forEach(function(t){var n=document.createElement("tr"),r=t.getData();o.forEach(function(e){var t=document.createElement("td"),o=e.getFieldValue(r);switch(void 0===o?"undefined":_typeof(o)){case"object":o=JSON.stringify(o);break;case"undefined":case"null":o="";break;default:o=o}t.innerHTML=o,n.appendChild(t)}),e.appendChild(n)}),e},HtmlTableExport.prototype.getHtml=function(e){var t=document.createElement("div");return t.appendChild(this.genereateTable()),t.innerHTML},Tabulator.prototype.registerModule("htmlTableExport",HtmlTableExport);