/* Tabulator v4.2.6 (c) Oliver Folkerd */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},HtmlTableExport=function(t){this.table=t,this.config={},this.cloneTableStyle=!0};HtmlTableExport.prototype.genereateTable=function(t,e,o){this.cloneTableStyle=e,this.config=t||{};var r=this.generateHeaderElements(),n=this.generateBodyElements(o),l=document.createElement("table");return l.classList.add("tabulator-print-table"),l.appendChild(r),l.appendChild(n),this.mapElementStyles(this.table.element,l,["border-top","border-left","border-right","border-bottom"]),l},HtmlTableExport.prototype.generateColumnGroupHeaders=function(){var t=this,e=[];return(!1!==this.config.columnGroups?this.table.columnManager.columns:this.table.columnManager.columnsByIndex).forEach(function(o){var r=t.processColumnGroup(o);r&&e.push(r)}),e},HtmlTableExport.prototype.processColumnGroup=function(t){var e=this,o=t.columns,r=0,n={title:t.definition.title,column:t,depth:1};if(o.length){if(n.subGroups=[],n.width=0,o.forEach(function(t){var o=e.processColumnGroup(t);o&&(n.width+=o.width,n.subGroups.push(o),o.depth>r&&(r=o.depth))}),n.depth+=r,!n.width)return!1}else{if(!t.field||!t.visible)return!1;n.width=1}return n},HtmlTableExport.prototype.groupHeadersToRows=function(t){function e(t,n){var l=r-n;void 0===o[n]&&(o[n]=[]),t.height=t.subGroups?1:l-t.depth+1,o[n].push(t),t.subGroups&&t.subGroups.forEach(function(t){e(t,n+1)})}var o=[],r=0;return t.forEach(function(t){t.depth>r&&(r=t.depth)}),t.forEach(function(t){e(t,0)}),o},HtmlTableExport.prototype.generateHeaderElements=function(){var t=this,e=document.createElement("thead");return this.groupHeadersToRows(this.generateColumnGroupHeaders()).forEach(function(o){var r=document.createElement("tr");t.mapElementStyles(t.table.columnManager.getHeadersElement(),e,["border-top","border-left","border-right","border-bottom","background-color","color","font-weight","font-family","font-size"]),o.forEach(function(e){var o=document.createElement("th");o.colSpan=e.width,o.rowSpan=e.height,o.innerHTML=e.column.definition.title,t.cloneTableStyle&&(o.style.boxSizing="border-box"),t.mapElementStyles(e.column.getElement(),o,["width","text-align","border-top","border-left","border-right","border-bottom","background-color","color","font-weight","font-family","font-size"]),t.mapElementStyles(e.column.contentElement,o,["padding-top","padding-left","padding-right","padding-bottom"]),e.column.parent&&t.mapElementStyles(e.column.parent.groupElement,o,["border-top"]),r.appendChild(o)}),e.appendChild(r)}),e},HtmlTableExport.prototype.generateBodyElements=function(t){var e,o,r,n,l,a,i,d,u=this;this.cloneTableStyle&&window.getComputedStyle&&(e=this.table.element.querySelector(".tabulator-row-odd:not(.tabulator-group):not(.tabulator-calcs)"),o=this.table.element.querySelector(".tabulator-row-even:not(.tabulator-group):not(.tabulator-calcs)"),r=this.table.element.querySelector(".tabulator-row.tabulator-calcs"),n=this.table.element.querySelector(".tabulator-row:not(.tabulator-group):not(.tabulator-calcs)"),a=this.table.element.getElementsByClassName("tabulator-group")[0],n&&(i=n.getElementsByClassName("tabulator-cell"),l=i[0],i[i.length-1]));var p=document.createElement("tbody"),c=t?this.table.rowManager.getVisibleRows(!0):this.table.rowManager.getDisplayRows(),s=this.table.columnManager.columnsByIndex;return c=c.filter(function(t){switch(t.type){case"group":return!1!==u.config.rowGroups;case"calc":return!1!==u.config.columnCalcs}return!0}),c.forEach(function(t,n){var i=t.getData(),c=document.createElement("tr");switch(c.classList.add("tabulator-print-table-row"),t.type){case"group":var m=document.createElement("td");m.colSpan=s.length,m.innerHTML=t.key,c.classList.add("tabulator-print-table-group"),u.mapElementStyles(a,c,["border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","background-color"]),u.mapElementStyles(a,m,["padding-top","padding-left","padding-right","padding-bottom"]),c.appendChild(m);break;case"calc":c.classList.add("tabulator-print-table-calcs");case"row":s.forEach(function(t){var e=document.createElement("td"),o=t.getFieldValue(i),r={getValue:function(){return o},getField:function(){return t.definition.field},getElement:function(){return e},getColumn:function(){return t.getComponent()},getRow:function(){return{normalizeHeight:function(){}}},getComponent:function(){return r},column:t};if(u.table.modExists("format"))o=u.table.modules.format.formatValue(r);else switch(void 0===o?"undefined":_typeof(o)){case"object":o=JSON.stringify(o);break;case"undefined":case"null":o="";break;default:o=o}o instanceof Node?e.appendChild(o):e.innerHTML=o,l&&u.mapElementStyles(l,e,["padding-top","padding-left","padding-right","padding-bottom","border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","text-align"]),c.appendChild(e)}),d="calc"==t.type?r:n%2&&o?o:e,u.mapElementStyles(d,c,["border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","background-color"])}p.appendChild(c)}),p},HtmlTableExport.prototype.getHtml=function(t,e,o){var r=document.createElement("div");return r.appendChild(this.genereateTable(o||this.table.options.htmlOutputConfig,e,t)),r.innerHTML},HtmlTableExport.prototype.mapElementStyles=function(t,e,o){if(this.cloneTableStyle&&t&&e){var r={"background-color":"backgroundColor",color:"fontColor",width:"width","font-weight":"fontWeight","font-family":"fontFamily","font-size":"fontSize","text-align":"textAlign","border-top":"borderTop","border-left":"borderLeft","border-right":"borderRight","border-bottom":"borderBottom","padding-top":"paddingTop","padding-left":"paddingLeft","padding-right":"paddingRight","padding-bottom":"paddingBottom"};if(window.getComputedStyle){var n=window.getComputedStyle(t);o.forEach(function(t){e.style[r[t]]=n.getPropertyValue(t)})}}},Tabulator.prototype.registerModule("htmlTableExport",HtmlTableExport);