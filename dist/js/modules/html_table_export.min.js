/* Tabulator v4.2.5 (c) Oliver Folkerd */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},HtmlTableExport=function(e){this.table=e,this.config={}};HtmlTableExport.prototype.genereateTable=function(e){var t=this.generateHeaderElements(),n=this.generateBodyElements(),o=document.createElement("table");return o.appendChild(t),o.appendChild(n),o},HtmlTableExport.prototype.generateColumnGroupHeaders=function(){var e=this,t=[];return this.table.columnManager.columns.forEach(function(n){var o=e.processColumnGroup(n);o&&t.push(o)}),t},HtmlTableExport.prototype.processColumnGroup=function(e){var t=this,n=e.columns,o=0,r={title:e.definition.title,column:e,depth:1};if(n.length){if(r.subGroups=[],r.width=0,n.forEach(function(e){var n=t.processColumnGroup(e);n&&(r.width+=n.width,r.subGroups.push(n),n.depth>o&&(o=n.depth))}),r.depth+=o,!r.width)return!1}else{if(!e.field||!e.visible)return!1;r.width=1}return r},HtmlTableExport.prototype.groupHeadersToRows=function(e){function t(e,r){var a=o-r;void 0===n[r]&&(n[r]=[]),e.height=e.subGroups?1:a-e.depth+1,n[r].push(e),e.subGroups&&e.subGroups.forEach(function(e){t(e,r+1)})}var n=[],o=0;return e.forEach(function(e){e.depth>o&&(o=e.depth)}),e.forEach(function(e){t(e,0)}),n},HtmlTableExport.prototype.generateHeaderElements=function(){var e=document.createElement("thead");return this.groupHeadersToRows(this.generateColumnGroupHeaders()).forEach(function(t){var n=document.createElement("tr");t.forEach(function(e){var t=document.createElement("th");t.colSpan=e.width,t.rowSpan=e.height,t.innerHTML=e.column.definition.title,n.appendChild(t)}),e.appendChild(n)}),e},HtmlTableExport.prototype.generateBodyElements=function(){var e=document.createElement("tbody"),t=this.table.rowManager.getDisplayRows(),n=this.table.columnManager.columnsByIndex;return t.forEach(function(t){var o=document.createElement("tr"),r=t.getData();switch(t.type){case"group":var a=document.createElement("td");a.colSpan=n.length,a.innerHTML=t.key,o.appendChild(a);break;case"row":n.forEach(function(e){var t=document.createElement("td"),n=e.getFieldValue(r);switch(void 0===n?"undefined":_typeof(n)){case"object":n=JSON.stringify(n);break;case"undefined":case"null":n="";break;default:n=n}t.innerHTML=n,o.appendChild(t)})}e.appendChild(o)}),e},HtmlTableExport.prototype.getHtml=function(e){var t=document.createElement("div");return t.appendChild(this.genereateTable()),t.innerHTML},Tabulator.prototype.registerModule("htmlTableExport",HtmlTableExport);