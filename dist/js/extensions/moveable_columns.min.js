/* Tabulator v4.0.0 (c) Oliver Folkerd */
"use strict";var MoveColumns=function(e){this.table=e,this.placeholderElement=$("<div class='tabulator-col tabulator-col-placeholder'></div>"),this.hoverElement=$(),this.checkTimeout=!1,this.checkPeriod=250,this.moving=!1,this.toCol=!1,this.toColAfter=!1,this.startX=0,this.autoScrollMargin=40,this.autoScrollStep=5,this.autoScrollTimeout=!1,this.moveHover=this.moveHover.bind(this),this.endMove=this.endMove.bind(this)};MoveColumns.prototype.initializeColumn=function(e){var o=this,t={};e.extensions.frozen||(t.mousemove=function(t){e.parent===o.moving.parent&&(t.pageX-e.element.offset().left+o.table.columnManager.element.scrollLeft()>e.getWidth()/2?o.toCol===e&&o.toColAfter||(e.element.after(o.placeholderElement),o.moveColumn(e,!0)):(o.toCol!==e||o.toColAfter)&&(e.element.before(o.placeholderElement),o.moveColumn(e,!1)))}.bind(o),e.getElement().on("mousedown",function(t){o.checkTimeout=setTimeout(function(){o.startMove(t,e)},o.checkPeriod)}),e.getElement().on("mouseup",function(e){o.checkTimeout&&clearTimeout(o.checkTimeout)})),e.extensions.moveColumn=t},MoveColumns.prototype.startMove=function(e,o){var t=this,n=o.getElement();t.moving=o,t.startX=e.pageX-n.offset().left,t.table.element.addClass("tabulator-block-select"),t.placeholderElement.css({width:o.getWidth(),height:o.getHeight()}),n.before(t.placeholderElement),n.detach(),t.hoverElement=n.clone(),t.hoverElement.addClass("tabulator-moving"),t.table.columnManager.getElement().append(t.hoverElement),t.hoverElement.css({left:0,bottom:0}),t._bindMouseMove(),$("body").on("mousemove",t.moveHover),$("body").on("mouseup",t.endMove),t.moveHover(e)},MoveColumns.prototype._bindMouseMove=function(){this.table.columnManager.columnsByIndex.forEach(function(e){e.extensions.moveColumn.mousemove&&e.element.on("mousemove",e.extensions.moveColumn.mousemove)})},MoveColumns.prototype._unbindMouseMove=function(){this.table.columnManager.columnsByIndex.forEach(function(e){e.extensions.moveColumn.mousemove&&e.element.off("mousemove",e.extensions.moveColumn.mousemove)})},MoveColumns.prototype.moveColumn=function(e,o){var t=this,n=this.moving.getCells();t.toCol=e,t.toColAfter=o,o?e.getCells().forEach(function(e,o){e.getElement().after(n[o].getElement())}):e.getCells().forEach(function(e,o){e.getElement().before(n[o].getElement())})},MoveColumns.prototype.endMove=function(e){var o=this;o._unbindMouseMove(),o.placeholderElement.after(o.moving.getElement()),o.placeholderElement.detach(),o.hoverElement.detach(),o.table.element.removeClass("tabulator-block-select"),o.toCol&&o.table.columnManager.moveColumn(o.moving,o.toCol,o.toColAfter),o.moving=!1,o.toCol=!1,o.toColAfter=!1,$("body").off("mousemove",o.moveHover),$("body").off("mouseup",o.endMove)},MoveColumns.prototype.moveHover=function(e){var o,t=this,n=t.table.columnManager.getElement(),l=n.scrollLeft(),m=e.pageX-n.offset().left+l;t.hoverElement.css({left:m-t.startX}),m-l<t.autoScrollMargin&&(t.autoScrollTimeout||(t.autoScrollTimeout=setTimeout(function(){o=Math.max(0,l-5),t.table.rowManager.getElement().scrollLeft(o),t.autoScrollTimeout=!1},1))),l+n.innerWidth()-m<t.autoScrollMargin&&(t.autoScrollTimeout||(t.autoScrollTimeout=setTimeout(function(){o=Math.min(n.innerWidth(),l+5),t.table.rowManager.getElement().scrollLeft(o),t.autoScrollTimeout=!1},1)))},Tabulator.prototype.registerExtension("moveColumn",MoveColumns);